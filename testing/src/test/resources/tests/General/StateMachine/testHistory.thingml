import "../../thingml.thingml"

thing TestHistory includes Test 
@test "t # IC0(1X)?"
@test "tntt # IC0123XIC2(3X)?"

{
	statechart TestHistory init I {
		internal event Test?Done
		action TestDone()
	
		state I {
			on entry TestOut('\'I\'' as Char)
			transition -> C
			event m : Test?In
			guard m.c == '\'t\''
		}
		
		composite state C init C1 keeps history {
		
		on entry TestOut('\'C\'' as Char)
		on exit TestOut('\'X\'' as Char)
		transition -> I
		event m : Test?In
		guard m.c == '\'t\''
		
			state C1 {
				on entry TestOut('\'0\'' as Char)
				on exit TestOut('\'1\'' as Char)
				transition -> C2
				event m : Test?In
				guard m.c == '\'n\''
			}
			
			state C2 {
				on entry TestOut('\'2\'' as Char)
				on exit TestOut('\'3\'' as Char)
				transition -> C1
				event m : Test?In
				guard m.c == '\'n\''
			}
		}
	}
}
